<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>RT-Thread RTOS: 组件初始化</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RT-Thread RTOS
   &#160;<span id="projectnumber">3.1.0</span>
   </div>
   <div id="projectbrief">An open source embedded real-time operating system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li><a href="modules.html"><span>模块</span></a></li>
      <li><a href="annotated.html"><span>结构体</span></a></li>
      <li><a href="examples.html"><span>示例</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">宏定义</a>  </div>
  <div class="headertitle">
<div class="title">组件初始化<div class="ingroups"><a class="el" href="group___kernel.html">内核</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>RT-Thread 的自动初始化机制  
<a href="#details">更多...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
宏定义</h2></td></tr>
<tr class="memitem:ga4aa2959ed380e57bb80c380b2e32baad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__component.html#ga4aa2959ed380e57bb80c380b2e32baad">INIT_BOARD_EXPORT</a>(fn)                  &#160;&#160;&#160;INIT_EXPORT(fn, &quot;1&quot;)</td></tr>
<tr class="memdesc:ga4aa2959ed380e57bb80c380b2e32baad"><td class="mdescLeft">&#160;</td><td class="mdescRight">板级驱动初始化  <a href="#ga4aa2959ed380e57bb80c380b2e32baad">更多...</a><br /></td></tr>
<tr class="separator:ga4aa2959ed380e57bb80c380b2e32baad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae3b33d422de2067a0da1c8280b81eeb4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__component.html#gae3b33d422de2067a0da1c8280b81eeb4">INIT_PREV_EXPORT</a>(fn)                    &#160;&#160;&#160;INIT_EXPORT(fn, &quot;2&quot;)</td></tr>
<tr class="memdesc:gae3b33d422de2067a0da1c8280b81eeb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">纯软件函数自动初始化  <a href="#gae3b33d422de2067a0da1c8280b81eeb4">更多...</a><br /></td></tr>
<tr class="separator:gae3b33d422de2067a0da1c8280b81eeb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga84a12044d94835e08bd23913698fe2ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__component.html#ga84a12044d94835e08bd23913698fe2ac">INIT_DEVICE_EXPORT</a>(fn)                &#160;&#160;&#160;INIT_EXPORT(fn, &quot;3&quot;)</td></tr>
<tr class="memdesc:ga84a12044d94835e08bd23913698fe2ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">设备自动初始化  <a href="#ga84a12044d94835e08bd23913698fe2ac">更多...</a><br /></td></tr>
<tr class="separator:ga84a12044d94835e08bd23913698fe2ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbf6a5e53aff8a1d78117e20afcd9d73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__component.html#gafbf6a5e53aff8a1d78117e20afcd9d73">INIT_COMPONENT_EXPORT</a>(fn)          &#160;&#160;&#160;INIT_EXPORT(fn, &quot;4&quot;)</td></tr>
<tr class="memdesc:gafbf6a5e53aff8a1d78117e20afcd9d73"><td class="mdescLeft">&#160;</td><td class="mdescRight">组件自动初始化  <a href="#gafbf6a5e53aff8a1d78117e20afcd9d73">更多...</a><br /></td></tr>
<tr class="separator:gafbf6a5e53aff8a1d78117e20afcd9d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ccf13c18fcece8cd24c8fb04b349a3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__component.html#ga0ccf13c18fcece8cd24c8fb04b349a3e">INIT_ENV_EXPORT</a>(fn)                      &#160;&#160;&#160;INIT_EXPORT(fn, &quot;5&quot;)</td></tr>
<tr class="memdesc:ga0ccf13c18fcece8cd24c8fb04b349a3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">系统环境自动初始化  <a href="#ga0ccf13c18fcece8cd24c8fb04b349a3e">更多...</a><br /></td></tr>
<tr class="separator:ga0ccf13c18fcece8cd24c8fb04b349a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2982a679e49702a858501e1366684e25"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__component.html#ga2982a679e49702a858501e1366684e25">INIT_APP_EXPORT</a>(fn)                      &#160;&#160;&#160;INIT_EXPORT(fn, &quot;6&quot;)</td></tr>
<tr class="memdesc:ga2982a679e49702a858501e1366684e25"><td class="mdescLeft">&#160;</td><td class="mdescRight">应用自动初始化  <a href="#ga2982a679e49702a858501e1366684e25">更多...</a><br /></td></tr>
<tr class="separator:ga2982a679e49702a858501e1366684e25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<p>RT-Thread 的自动初始化机制 </p>
<p>一般来说，在系统里添加新的功能模块的时候，在使用前都必须先初始化， 通常的做法是在主程序运行前手动添加调用初始化函数。 而 RT-Thread 提供了另一种低耦合高内聚的初始化方式，它不需要我们再 手动添加调用初始化函数，它能在系统运行前自动完成各模块的初始化。</p>
<p>组件初始化方式要求初始化函数主动通过一些宏接口进行申明，链接器会 自动收集所有被申明的初始化函数，放到特定的数据段中，数据段中的 所有函数在系统初始化时会被自动调用。</p>
<p>组件初始化的所有宏接口及其被初始化的顺序如表所示：</p>
<table class="doxtable">
<tr>
<th>初始化顺序 </th><th>接口  </th></tr>
<tr>
<td>1 </td><td><a class="el" href="group__component.html#ga4aa2959ed380e57bb80c380b2e32baad" title="板级驱动初始化 ">INIT_BOARD_EXPORT(fn)</a>; </td></tr>
<tr>
<td>2 </td><td><a class="el" href="group__component.html#gae3b33d422de2067a0da1c8280b81eeb4" title="纯软件函数自动初始化 ">INIT_PREV_EXPORT(fn)</a>; </td></tr>
<tr>
<td>3 </td><td><a class="el" href="group__component.html#ga84a12044d94835e08bd23913698fe2ac" title="设备自动初始化 ">INIT_DEVICE_EXPORT(fn)</a>; </td></tr>
<tr>
<td>4 </td><td><a class="el" href="group__component.html#gafbf6a5e53aff8a1d78117e20afcd9d73" title="组件自动初始化 ">INIT_COMPONENT_EXPORT(fn)</a>; </td></tr>
<tr>
<td>5 </td><td><a class="el" href="group__component.html#ga0ccf13c18fcece8cd24c8fb04b349a3e" title="系统环境自动初始化 ">INIT_ENV_EXPORT(fn)</a>; </td></tr>
<tr>
<td>6 </td><td><a class="el" href="group__component.html#ga2982a679e49702a858501e1366684e25" title="应用自动初始化 ">INIT_APP_EXPORT(fn)</a>; </td></tr>
</table>
<h2 class="groupheader">宏定义说明</h2>
<a class="anchor" id="ga4aa2959ed380e57bb80c380b2e32baad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_BOARD_EXPORT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn</td><td>)</td>
          <td>&#160;&#160;&#160;INIT_EXPORT(fn, &quot;1&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>板级驱动初始化 </p>
<p>rt_components_board_init()函数通常会运行板级驱动初始化函数， 例如：串口、CAN接口的电路初始化配置配置和设备注册，...</p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">fn</td><td>函数指针 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gae3b33d422de2067a0da1c8280b81eeb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_PREV_EXPORT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn</td><td>)</td>
          <td>&#160;&#160;&#160;INIT_EXPORT(fn, &quot;2&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>纯软件函数自动初始化 </p>
<p>这里通常这里会运行一些预初始化函数。</p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">fn</td><td>函数指针 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga84a12044d94835e08bd23913698fe2ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_DEVICE_EXPORT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn</td><td>)</td>
          <td>&#160;&#160;&#160;INIT_EXPORT(fn, &quot;3&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>设备自动初始化 </p>
<p>这里通常会运行一些设备相关的应用初始换函数，例如：串口通讯设置，...</p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">fn</td><td>函数指针 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gafbf6a5e53aff8a1d78117e20afcd9d73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_COMPONENT_EXPORT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn</td><td>)</td>
          <td>&#160;&#160;&#160;INIT_EXPORT(fn, &quot;4&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>组件自动初始化 </p>
<p>这里通常会自动初始化一些系统组件，例如：dfs文件系统，lwip协议等，...</p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">fn</td><td>函数指针 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga0ccf13c18fcece8cd24c8fb04b349a3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_ENV_EXPORT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn</td><td>)</td>
          <td>&#160;&#160;&#160;INIT_EXPORT(fn, &quot;5&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>系统环境自动初始化 </p>
<p>这里通常会初始化一些系统运行环境，如：mount disk, ..</p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">fn</td><td>函数指针 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga2982a679e49702a858501e1366684e25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_APP_EXPORT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn</td><td>)</td>
          <td>&#160;&#160;&#160;INIT_EXPORT(fn, &quot;6&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>应用自动初始化 </p>
<p>这里通常会自动运行一些用户的应用线程，例如：LCD显示，...</p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">fn</td><td>函数指针 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
生成于 2018年 十月 25日 星期四 00:39:49 , 为 RT-Thread RTOS使用  &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
